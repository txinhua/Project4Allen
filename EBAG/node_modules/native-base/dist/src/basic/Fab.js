Object.defineProperty(exports,"__esModule",{value:true});exports.Fab=undefined;var _jsxFileName='src/basic/Fab.js';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);var _nativeBaseShoutemTheme=require('native-base-shoutem-theme');var _platform=require('../theme/variables/platform');var _platform2=_interopRequireDefault(_platform);var _computeProps=require('../utils/computeProps');var _computeProps2=_interopRequireDefault(_computeProps);var _mapPropsToStyleNames=require('../utils/mapPropsToStyleNames');var _mapPropsToStyleNames2=_interopRequireDefault(_mapPropsToStyleNames);var _Button=require('./Button');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var DIRECTION={DOWN:'down',LEFT:'left',RIGHT:'right',UP:'up'};var POSITION={BOTTOM_LEFT:'bottomLeft',BOTTOM_RIGHT:'bottomRight',TOP_LEFT:'topLeft',TOP_RIGHT:'topRight'};var AnimatedFab=_reactNative.Animated.createAnimatedComponent(_Button.Button);var Fab=function(_Component){_inherits(Fab,_Component);function Fab(props){_classCallCheck(this,Fab);var _this=_possibleConstructorReturn(this,(Fab.__proto__||Object.getPrototypeOf(Fab)).call(this,props));_this.prepareButtonProps=function(child){var inp=_lodash2.default.clone(child.props);delete inp.style;var defaultProps={};return(0,_computeProps2.default)(inp,defaultProps);};_this.fabTopValue=function(pos){if(pos==='topLeft'){return{top:20,bottom:undefined,left:20,right:undefined};}else if(pos==='bottomRight'){return{top:undefined,bottom:20,left:undefined,right:20};}else if(pos==='bottomLeft'){return{top:undefined,bottom:20,left:20,right:undefined};}else if(pos==='topRight'){return{top:20,bottom:undefined,left:undefined,right:20};}return null;};_this.containerHeight=new _reactNative.Animated.Value(_platform2.default.fabWidth);_this.containerWidth=new _reactNative.Animated.Value(0);_this.buttonScale=new _reactNative.Animated.Value(0);_this.state={buttons:undefined,active:false};return _this;}_createClass(Fab,[{key:'componentDidMount',value:function componentDidMount(){var _this2=this;var childrenArray=_react2.default.Children.toArray(this.props.children);var icon=_lodash2.default.remove(childrenArray,function(item){if(item.type.displayName==='Styled(Button)'){return true;}return null;});this.setState({buttons:icon.length});this.activeTimer=setTimeout(function(){_this2.setState({active:_this2.props.active});},0);}},{key:'componentWillUnmount',value:function componentWillUnmount(){if(this.activeTimer){clearTimeout(this.activeTimer);}}},{key:'getOtherButtonStyle',value:function getOtherButtonStyle(child,i){var type={top:this.props.direction?this.fabOtherBtns(this.props.direction,i).top:undefined,left:this.props.direction?this.fabOtherBtns(this.props.direction,i).left:8,right:this.props.direction?this.fabOtherBtns(this.props.direction,i).right:0,bottom:this.props.direction?this.fabOtherBtns(this.props.direction,i).bottom:this.props.active===false?_reactNative.Platform.OS==='ios'?8:8:i*50+50};return _lodash2.default.merge(this.getInitialStyle().buttonStyle,_reactNative.StyleSheet.flatten(child.props.style),type);}},{key:'getContainerStyle',value:function getContainerStyle(){return _lodash2.default.merge(this.getInitialStyle().container,this.props.containerStyle);}},{key:'getInitialStyle',value:function getInitialStyle(iconStyle){return{fab:{height:_platform2.default.fabWidth,width:_platform2.default.fabWidth,borderRadius:28,elevation:4,shadowColor:'#000',shadowOffset:{width:0,height:2},shadowOpacity:0.4,justifyContent:'center',alignItems:'center',shadowRadius:2,position:'absolute',bottom:0,backgroundColor:'blue'},container:{position:'absolute',top:this.props.position?this.fabTopValue(this.props.position).top:undefined,bottom:this.props.position?this.fabTopValue(this.props.position).bottom:20,right:this.props.position?this.fabTopValue(this.props.position).right:20,left:this.props.position?this.fabTopValue(this.props.position).left:undefined,width:_platform2.default.fabWidth,height:this.containerHeight,flexDirection:this.props.direction?this.props.direction===DIRECTION.LEFT||this.props.direction===DIRECTION.RIGHT?'row':'column':'column',alignItems:'center'},iconStyle:_extends({color:'#fff',fontSize:24,lineHeight:_reactNative.Platform.OS==='ios'?27:undefined},iconStyle),buttonStyle:{position:'absolute',height:40,width:40,left:7,borderRadius:20,transform:this.state.active?[{scale:new _reactNative.Animated.Value(1)}]:[{scale:this.buttonScale}],marginBottom:10,backgroundColor:'blue'}};}},{key:'fabOtherBtns',value:function fabOtherBtns(direction,i){if(direction===DIRECTION.UP){return{top:undefined,bottom:this.props.active===false?_reactNative.Platform.OS==='ios'?50:5:i*50+65,left:8,right:0};}else if(direction===DIRECTION.LEFT){return{top:8,bottom:0,left:this.props.active===false?_reactNative.Platform.OS==='ios'?8:8:-(i*50+_platform2.default.fabWidth+2),right:0};}else if(direction===DIRECTION.DOWN){return{top:this.props.active===false?_reactNative.Platform.OS==='ios'?50:8:i*50+73,bottom:0,left:8,right:0};}else if(direction===DIRECTION.RIGHT){return{top:8,bottom:0,left:this.props.active===false?_reactNative.Platform.OS==='ios'?50:8:i*50+73,right:0};}return null;}},{key:'prepareFabProps',value:function prepareFabProps(){var defaultProps={style:this.getInitialStyle().fab};var incomingProps=_lodash2.default.clone(this.props);delete incomingProps.onPress;return(0,_computeProps2.default)(incomingProps,defaultProps);}},{key:'upAnimate',value:function upAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerHeight,{toValue:this.state.buttons*51.3+_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:'leftAnimate',value:function leftAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerWidth,{toValue:this.state.buttons*51.3+_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:'rightAnimate',value:function rightAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerWidth,{toValue:this.state.buttons*51.3+_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:'downAnimate',value:function downAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerHeight,{toValue:_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform2.default.fabWidth}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:'_animate',value:function _animate(){var _props=this.props,direction=_props.direction,position=_props.position;if(direction){if(direction===DIRECTION.UP){if(position===POSITION.TOP_LEFT||position===POSITION.TOP_RIGHT){console.warn('Passing direction = up with position = topLeft/topRight is not suggested.');}else{this.upAnimate();}}else if(direction===DIRECTION.LEFT){if(position===POSITION.TOP_LEFT||position===POSITION.BOTTOM_LEFT){console.warn('Passing direction = left with position = topLeft/bottomLeft is not suggested.');}else{this.leftAnimate();}}else if(direction===DIRECTION.RIGHT){if(position===POSITION.TOP_RIGHT||position===POSITION.BOTTOM_RIGHT){console.warn('Passing direction = right with position = topRight/bottomRight is not suggested.');}else{this.rightAnimate();}}else if(direction===DIRECTION.DOWN){if(position===POSITION.BOTTOM_LEFT||position===POSITION.BOTTOM_RIGHT){console.warn('Passing direction = down with position = bottomLeft/bottomRight is not suggested.');}else{this.downAnimate();}}}else{this.upAnimate();}}},{key:'fabOnPress',value:function fabOnPress(){var _this3=this;if(this.props.onPress){this.props.onPress();this._animate();this.activeTimer=setTimeout(function(){_this3.setState({active:_this3.props.active});},100);}}},{key:'renderButtons',value:function renderButtons(){var _this4=this;var childrenArray=_react2.default.Children.toArray(this.props.children);var newChildren=[];childrenArray.slice(1).map(function(child,i){return newChildren.push(_react2.default.createElement(AnimatedFab,_extends({style:_this4.getOtherButtonStyle(child,i)},_this4.prepareButtonProps(child,i),{fabButton:true,key:i,__source:{fileName:_jsxFileName,lineNumber:432}}),child.props.children));});return newChildren;}},{key:'renderFab',value:function renderFab(){var childrenArray=_react2.default.Children.toArray(this.props.children);_lodash2.default.remove(childrenArray,function(item){if(item.type.displayName==='Styled(Button)'){return true;}return null;});return _react2.default.cloneElement(childrenArray[0],{style:this.getInitialStyle(childrenArray[0].props.style).iconStyle});}},{key:'render',value:function render(){var _this5=this;return _react2.default.createElement(_reactNative.Animated.View,{style:this.getContainerStyle(),__source:{fileName:_jsxFileName,lineNumber:460}},this.renderButtons(),_reactNative.Platform.OS==='ios'||_platform2.default.androidRipple===false||_reactNative.Platform.Version<=21?_react2.default.createElement(_reactNative.TouchableOpacity,_extends({onPress:function onPress(){return _this5.fabOnPress();}},this.prepareFabProps(),{activeOpacity:1,__source:{fileName:_jsxFileName,lineNumber:465}}),this.renderFab()):_react2.default.createElement(_reactNative.TouchableNativeFeedback,_extends({onPress:function onPress(){return _this5.fabOnPress();},background:_reactNative.TouchableNativeFeedback.Ripple(_platform2.default.androidRippleColor,false)},this.prepareFabProps(),{__source:{fileName:_jsxFileName,lineNumber:473}}),_react2.default.createElement(_reactNative.View,{style:[this.getInitialStyle().fab,this.props.style],__source:{fileName:_jsxFileName,lineNumber:482}},this.renderFab())));}}]);return Fab;}(_react.Component);var StyledFab=(0,_nativeBaseShoutemTheme.connectStyle)('NativeBase.Fab',{},_mapPropsToStyleNames2.default)(Fab);exports.Fab=StyledFab;
//# sourceMappingURL=Fab.js.map